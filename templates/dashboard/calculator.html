{% extends 'dashboard/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Energy Calculator - Entrack{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <div class="bg-white rounded-lg shadow-lg p-6 card card-gradient-1 animate-on-scroll">
        <div class="card-header">
            <h2 class="text-2xl font-bold mb-2 text-white section-title">Carbon Footprint Calculator</h2>
        </div>
        <div class="p-4 bg-white rounded-lg mt-4">
            {% if has_previous_data %}
            <p class="text-gray-700 mb-6">Enter your monthly energy usage data to calculate your carbon footprint and see how many trees you've helped grow through your energy savings!</p>
            {% else %}
            <p class="text-gray-700 mb-6">Welcome! Enter your first monthly energy usage data. We'll start calculating your savings and environmental impact from your next entry.</p>
            {% endif %}
            
            <form method="POST" class="space-y-6">
                {% csrf_token %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {{ form|crispy }}
                </div>
                <button type="submit" class="btn-primary">
                    {% if has_previous_data %}
                    Calculate Impact
                    {% else %}
                    Submit First Entry
                    {% endif %}
                </button>
            </form>
        </div>
    </div>
    
    {% if has_previous_data %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
        <div class="bg-white rounded-lg shadow-lg p-6 card card-gradient-2 animate-on-scroll">
            <div class="card-header">
                <h2 class="text-2xl font-bold mb-2 text-white section-title">Energy Usage Trends</h2>
            </div>
            <div class="p-4 bg-white rounded-lg mt-4">
                <canvas id="usageChart" height="250"></canvas>
            </div>
        </div>
        <div class="bg-white rounded-lg shadow-lg p-6 card card-gradient-3 animate-on-scroll">
            <div class="card-header">
                <h2 class="text-2xl font-bold mb-2 text-white section-title">Energy Savings</h2>
            </div>
            <div class="p-4 bg-white rounded-lg mt-4">
                <canvas id="savingsChart" height="250"></canvas>
            </div>
        </div>
    </div>
    {% endif %}
    
    <div class="bg-white rounded-lg shadow-lg p-6 mt-8 card card-gradient-4 animate-on-scroll">
        <div class="card-header">
            <h2 class="text-2xl font-bold mb-2 text-white section-title">Energy Saving Tips</h2>
        </div>
        <div class="p-4 bg-white rounded-lg mt-4">
            <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                <p id="tip-text" class="text-green-800 text-lg mb-4">{{ energy_tip }}</p>
                <button id="newTipBtn" class="btn-primary" title="Get a new energy saving tip">
                    Get New Tip
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %} 